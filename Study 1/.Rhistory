NAME <- '1_scales'
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/1_scales.R", echo=TRUE)
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/0_run_all.R", echo=TRUE)
##------ Tue Aug 03 16:05:05 2021 ------##
warnings()
files <- list.files(here("2_code"), pattern = "\\.R$")[-1]
files
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/0_run_all.R", echo=TRUE)
warnings()
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/0_run_all.R", echo=TRUE)
fles
files
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/0_run_all.R", echo=TRUE)
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/2_div_contact_panel_latent.R", echo=TRUE)
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/4_div_contact_panel_observed.R", echo=TRUE)
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/5_plot_div_contact_panel_model_observed.R", echo=TRUE)
fit_std <- read_rds(here(pipelinedir, "4_div_contact_panel_observed/out/CrossLaggedModel.RDS"))
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/4_div_contact_panel_observed.R", echo=TRUE)
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/5_plot_div_contact_panel_model_observed.R", echo=TRUE)
source("~/Research/manuscripts/Valuing diversity - PhD results/Analyses - OSF/Study 1/2_code/0_run_all.R", echo=TRUE)
##------ Tue Aug 03 16:14:39 2021 ------##
NAME <- '2_div_contact_panel_latent'
# ------------
# Sources
# ------------
if (!require("pacman")) install.packages("pacman")
pacman::p_load(dplyr, magrittr, here, lavaan, readr, tidyr)
pacman::p_install_version(c("haven", "stringr", "purrr", "gt"),
c("2.3.1", "1.4.0", "0.3.4", "0.2.1"))
pacman::p_load_gh("lukaswallrich/rNuggets")
source(here("1_tools/managementFunctions.R"))
#Set up pipeline folder if missing
pipeline <- createPipelineDir(NAME)
datadir <- "0_data"
pipelinedir <- "3_pipeline"
AllCasesWhite <- read_rds(here(pipelinedir, "1_scales/out/WhiteCasesWScales.RDS"))
# ------------
# Model
# ------------
AllCasesWhite %<>% select(-c(ValDiv_2, BlackPOS_2, BlackNEG_2,
ValDiv_1, BlackPOS_1, BlackNEG_1))
xlag.measurement.model <- ("
ValDiv_1 =~ NA*ValDiv1 + ValDiv2 + ValDiv3
ValDiv_2 =~ NA*ValDiv1_2 + ValDiv2_2 + ValDiv3_2
BlackNEG_1 =~ NA*BlackRidiculed + BlackUnwanted + BlackVerbAbused + BlackIntimidated + BlackThreatened
BlackNEG_2 =~ NA*BlackRidiculed_2 + BlackUnwanted_2 + BlackVerbAbused_2 + BlackIntimidated_2 + BlackThreatened_2
BlackPOS_1 =~ NA*BlackComplimented + BlackBefriended + BlackWelcome + BlackSupported + BlackHelped
BlackPOS_2 =~ NA*BlackComplimented_2 + BlackBefriended_2 + BlackWelcome_2 + BlackSupported_2 + BlackHelped_2
ValDiv_2 ~~ 1*ValDiv_2
BlackPOS_2 ~~ 1*BlackPOS_2
BlackNEG_2 ~~ 1*BlackNEG_2
ValDiv_1 ~~ 1*ValDiv_1
BlackPOS_1 ~~ 1*BlackPOS_1
BlackNEG_1 ~~ 1*BlackNEG_1
ValDiv1_2 ~~ ValDiv1
ValDiv2_2 ~~ ValDiv2
ValDiv3_2 ~~ ValDiv3
BlackComplimented ~~ BlackComplimented_2
BlackBefriended ~~ BlackBefriended_2
BlackWelcome ~~ BlackWelcome_2
BlackSupported ~~ BlackSupported_2
BlackHelped ~~ BlackHelped_2
BlackRidiculed ~~ BlackRidiculed_2
BlackUnwanted ~~ BlackUnwanted_2
BlackVerbAbused ~~ BlackVerbAbused_2
BlackIntimidated ~~ BlackIntimidated_2
BlackThreatened ~~ BlackThreatened_2
")
fit_measurement <- sem(xlag.measurement.model, data=AllCasesWhite, missing = "fiml", std.lv = TRUE)
fitm <- fitmeasures(fit_measurement, fit.measures = c("cfi", "rmsea", "srmr", "chisq", "df"))
fitm %>% c(chisq_df = fitm["chisq"]/fitm["df"]) %>% round(3)
